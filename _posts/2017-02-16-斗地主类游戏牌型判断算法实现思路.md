---
layout:     post
title:      æ–—åœ°ä¸»ç±»æ¸¸æˆç‰Œå‹åˆ¤æ–­ç®—æ³•å®ç°æ€è·¯
subtitle:   
date:       2017-02-16
author:     lx8421bcd
header-img: img/post-bg-unix-linux.jpg
catalog: false
tags:
    - æ¸¸æˆå¼€å‘
---

æœ€è¿‘æ·±åº¦å‚ä¸äº†ä¸€æ¬¾åœ°æ–¹ç‰Œç±»æ¸¸æˆçš„å¼€å‘ï¼Œè§„åˆ™ç±»ä¼¼äºå››äººæ–—åœ°ä¸»ï¼Œæ¸¸æˆåšå¾—å°‘ï¼Œæ¯•ç«Ÿè¿˜æ˜¯å›¾æ ·å›¾æ£®ç ´ï¼Œä»»åŠ¡æ‹†åˆ†çš„æ—¶å€™ï¼Œä¼°æ—¶ä¼°è®¡çš„è¿‡äºä¹è§‚ï¼Œç»“æœä»˜å‡ºäº†è¿ç»­åŠ ç­çš„æƒ¨ç—›ä»£ä»·ğŸ˜­ã€‚ä¸è¿‡ç»è¿‡è¿™æ¬¡ç»å†ä¹Ÿç®—æ˜¯å¯¹ç‰Œç±»æ¸¸æˆå¼€å‘æœ‰äº†ä¸€å®šç¨‹åº¦çš„äº†è§£ã€‚

è¿™æ¬¡å¼€å‘ä¸­æˆ‘è§‰å¾—æœ€æœ‰æ„ä¹‰çš„å°±æ˜¯åœ¨å®¢æˆ·ç«¯å®ç°äº†ç‰Œå‹åˆ¤æ–­å’Œå‡ºç‰Œæç¤ºç®—æ³•ï¼Œç”±äºæ˜¯å·¥ä½œå†…å®¹ä¸èƒ½è´´ä»£ç ï¼Œæ‰€ä»¥è¿™é‡Œåªæ˜¯å™è¿°ä¸€ä¸‹å®ç°æ€è·¯ï¼Œå†™ç‚¹ä¼ªä»£ç åšä¸ªæ„æ€ï¼Œä½œä¸ºå¤‡ä»½ï¼Œå¦ä¸€æ–¹é¢ä¾›åæ¥è€…å‚è€ƒã€‚  

æ£‹ç‰Œç±»æ¸¸æˆå¼€å‘æµç¨‹å…¶å®å¾ˆåƒæ™®é€šçš„ç§»åŠ¨appï¼Œå› ä¸ºåœºæ™¯æ¯”è¾ƒå›ºå®šï¼Œäº¤äº’ä¹Ÿä¸å¤æ‚ã€‚ä¸€å±€æ¸¸æˆå§‹äºç©å®¶è¿›å…¥æˆ¿é—´å‡†å¤‡å°±ç»ªï¼Œç»ˆäºæ¸¸æˆç»“æŸç©å®¶é€€å‡ºæˆ¿é—´ã€‚ç‰Œå‹ã€åˆ¤æ–­è§„åˆ™è¿™äº›ä¸œè¥¿åœ¨æˆ¿é—´æœåŠ¡å†…å‡æœ‰å®šä¹‰ï¼Œè€Œå®¢æˆ·ç«¯ä¹Ÿéœ€è¦ä¸€ä»½åŒæ ·çš„å®šä¹‰ï¼Œç›¸æ¯”äºéº»å°†ï¼Œæ‰‘å…‹ç‰Œç±»æ¸¸æˆçš„æ•°æ®å®šä¹‰å¯è¦ç®€å•å¤ªå¤šäº†ã€‚æ‰‘å…‹ç‰Œè¿™ä¸ªæ•°æ®ç»“æ„ä¸€èˆ¬åŒ…å«ä»¥ä¸‹è¦ç´ ï¼š
```Lua
card = {
    id = 0, -- æ‰‘å…‹ç‰ŒIDï¼Œä¸€å‰¯æ‰‘å…‹54å¼ ç‰Œ + 1ç‰ŒèƒŒï¼Œæ¯ä¸€å¼ éƒ½æœ‰ä¸€ä¸ªç‹¬ä¸€çš„ID
    value = 1, -- ç‰Œç‚¹ï¼Œä»Aåˆ°Kï¼Œå¯¹åº”1-13
    suits = 1, -- èŠ±è‰²ï¼Œä¹Ÿæœ‰å¯¹åº”çš„æšä¸¾å€¼
}
```
ç”±äºæ–—åœ°ä¸»æ¸¸æˆä¸€èˆ¬æ˜¯æ— å…³èŠ±è‰²çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åšç‰Œå‹åˆ¤æ–­æ—¶ä¸»è¦åˆ¤æ–­çš„å°±æ˜¯ç‰Œå‹å’Œç‰Œç‚¹å¤§å°ã€‚

é¦–å…ˆæ¥è¯´ä¸‹ç‰Œå‹åˆ¤æ–­ï¼Œå¯¹äºæ–—åœ°ä¸»ç±»æ¸¸æˆï¼Œä¸€èˆ¬å¸¸è§çš„ç‰Œå‹æœ‰ä»¥ä¸‹å‡ ç§ï¼š
* nX (n >= 1) å•å¼ ã€å¯¹å­ã€ä¸‰å¼ ï¼ˆéƒ¨åˆ†åœ°åŒºç©æ³•ï¼‰ã€ç‚¸å¼¹
* nX + mY (n >= 3, m >= 1) ä¸‰å¸¦ä¸€ã€ä¸‰å¸¦äºŒ
* nX + nY + ... + nZ (n <= 3) è¿å¯¹ï¼ˆlen >= 3ï¼‰ã€é¡ºå­ï¼ˆn = 1, len > 5ï¼‰
* nJoker + nJOKER (n >= 1ï¼Œçœ‹ç”¨å‡ å‰¯ç‰Œ) å¤©ç‹ç‚¸

æŠŠä¸Šé¢åˆ—ä¸¾çš„ç‰Œå‹æŒ‰ç…§ç‰Œç‚¹åˆ†ç»„ï¼Œå¯ä»¥å°†ä»»æ„ç‰Œå‹æ•´ç†æˆä¸€ä¸ªæœ‰è‹¥å¹²ç›¸åŒç‰Œç‚¹ç‰Œç»„ç»„æˆçš„ç‰Œç»„åºåˆ—ï¼Œ
```Lua
-- ä»¥ä¸€ä¸ªä¸‰å¸¦äºŒä¸ºä¾‹ è¿™é‡Œä»…ä»¥cardIdä½œä¸ºåŒºåˆ†
-- åˆå§‹ç‰Œç»„: ä¸‰ä¸ªKå¸¦ä¸€å¯¹3
cardArr = {13, 26, 39, 52, 3, 16}
-- æ•´ç†åçš„åŒç‰Œç‚¹ç‰Œç»„åºåˆ— 3ä¸ªKï¼Œ2ä¸ª3
cardSeq = {{13, 26, 39, 52}, {3, 16}}
```
æ ¹æ®åºåˆ—é•¿åº¦å¯ä»¥å½¢æˆåˆæ­¥çš„åˆ¤æ–­è§„åˆ™ï¼š
* ç‰Œç»„é•¿åº¦ = 1ï¼Œ å•å¼ ã€å¯¹å­ã€ä¸‰å¼ ã€ç‚¸å¼¹ 
* ç‰Œç»„é•¿åº¦ = 2ï¼Œ ä¸‰å¸¦ä¸€ã€ä¸‰å¸¦äºŒã€å¤©ç‹ç‚¸
* ç‰Œç»„é•¿åº¦ >= 3ï¼Œ é¡ºå­ã€è¿å¯¹ã€è¿ä¸‰å¼ 

æŒ‰ç…§è¿™æ ·çš„é€»è¾‘ï¼Œæˆ‘ä»¬å°±æœ‰å½’ä¸€åŒ–çš„æ¯”è¾ƒç®€å•çš„æ–¹æ³•åŒºåˆ†ç‰Œå‹ã€‚  
```Lua
-- ä¼ å…¥ç‰Œç»„ç”ŸæˆåŒç‰Œç‚¹ç‰Œç»„åºåˆ—
local function genCardSeq(cardArr)
    local ret = {}
    for i = 1, #cardArr do
        local j
        for j = 1, #ret do
            if ret[j][1].value == cardArr[i].value then
                table.insert(ret[j], cardArr[i])
                break
            end
        end
        if #ret == 0 or j > #ret  then 
            sameValueSeq = {cardArr[i]}
            table.insert(ret, sameValueSeq)
        end
    end
    return ret
end

-- å¾—åˆ°ç‰Œå‹
local function getCardType(cardSeq)
    if #cardSeq = 1 then
        if #cardSeq[1] = 1 then
            return SINGLE
        elseif #cardSeq[1] = 2 then
            return DOUBLE
        elseif #cardSeq[1] = 3 then
            return THREE
        elseif #cardSeq[1] = 4 then
            return BOMB
        -- æ ¹æ®ç”¨å‡ å‰¯ç‰Œåˆ¤æ–­æ˜¯å¦æœ‰æ›´é«˜çº§åˆ«çš„ç‚¸å¼¹ç­‰
        end
    elseif #cardSeq = 2 then
        if isJokerBomb(cardSeq) then
            return JOKER_BOMB
        elseif isThreeAndOne(cardSeq) then
            return THREE_AND_ONE
        elseif isThreeAndTwo(cardSeq) then
            return THREE_AND_TWO
        end
    elseif #cardSeq >= 3 then
        if isSingeSequence(cardSeq) then
            return SINGLE_SEQUENCE
        elseif isDoubleSequence(cardSeq) then
            return DOUBLE_SEQUENCE
        end
    end
    return NONE
end

```
èƒ½å¤Ÿå–å¾—ç‰Œå‹å’Œæ¯”è¾ƒæ–¹æ³•ä¹‹åï¼Œå†™å‡ºç‰Œåˆ¤æ–­å°±æ¯”è¾ƒç®€å•äº†
```Lua
-- åˆ¤æ–­æ˜¯å¦èƒ½å‡ºç‰Œ
function judgeCanOut(outCardArr, handCardArr)
    local outCardSeq = genCardSeq(outCardArr)
    local handCardSeq = genCardSeq(handCardArr)

    local outCardType = getCardType(ourCardSeq)
    local handCardType = getCardType(handCardSeq)
    -- å¦‚æœæ‰‹ç‰Œä¸æ˜¯ä»»ä½•ç‰Œå‹ï¼Œè¿”å›false
    if handCardType == NONE then 
        return false
    -- å¤©ç‹ç‚¸ç›´æ¥GG
    elseif outCardType == JOKER_BOMB then
        return false
    -- å¦‚æœç‰Œå‹ä¸åŒ¹é…ï¼Œç›´æ¥åˆ¤æ–­æ˜¯ä¸æ˜¯å‡ºç‚¸å¼¹ï¼Œèƒ½å¦ç‚¸
    elseif outCardType ~= handCardType then
        return judgeBomb(outCardSeq, handCardSeq)
    -- æŒ‰ç‰Œå‹è¿›è¡Œåˆ¤æ–­ï¼Œè¿™æ ·æšä¸¾çš„å¥½å¤„æ˜¯éœ€è¦æ·»åŠ /å±è”½ç‰Œå‹æ—¶ä¿®æ”¹è¿…é€Ÿ
    elseif outCardType == SINGLE then
        return judgeSingle(outCardArr, handCardArr) -- åˆ¤æ–­å•å¼ ã€å¯¹å­ã€ä¸‰å¼ çš„æ–¹æ³•
    elseif outCardType == DOUBLE then
        return judgeSingle(outCardArr, handCardArr) -- åˆ¤æ–­å•å¼ ã€å¯¹å­ã€ä¸‰å¼ çš„æ–¹æ³•
    elseif outCardType == THREE_AND_ONE then
        return judgeThree(outCardSeq, handCardSeq) -- åˆ¤æ–­ä¸‰å¸¦ä¸€ã€ä¸‰å¸¦äºŒ

    ......

    elseif outCardType == SINGLE_SEQUENCE then
        return judgeSequence(outCardArr, handCardArr) --åˆ¤æ–­é¡ºå­
    elseif outCardType == BOMB then 
        return judgeBomb(outCardArr, handCardArr)
    end
    return false
end

......

```
è¿™é‡Œè¿˜å¯ä»¥æ ¹æ®æ¸¸æˆè§„åˆ™åšå‡ºä¸€äº›ä¼˜åŒ–ï¼Œå¹¶ä¸ä¸€å®šæ˜¯æ— è„‘æšä¸¾ï¼Œè¿™æ ·å‡ºç‰Œåˆ¤æ–­ç®—æ³•å°±åŸºæœ¬å†™å®Œäº†ï¼Œè°ƒç”¨æ—¶ä¼ å…¥ä¸Šå®¶å‡ºç‰Œå’Œå½“å‰é€‰ä¸­æ‰‹ç‰Œå³å¯å®Œæˆåˆ¤æ–­ã€‚  

åœ¨å‡ºç‰Œåˆ¤æ–­ç®—æ³•å®Œæˆä¹‹åï¼Œå‡ºç‰Œæç¤ºç®—æ³•å…¶å®ä¹Ÿæ¯”è¾ƒå®¹æ˜“äº†ï¼Œæ³¨æ„æ­¤å¤„è¯´çš„å‡ºç‰Œæç¤ºç®—æ³•åªæ˜¯ä¸€ä¸ªç®€å•çš„æç¤ºåŠŸèƒ½ï¼Œå¹¶ä¸ä¼šå»è®¡ç®—ç©å®¶å½“å‰å‡ºä»€ä¹ˆç‰Œç»„æ˜¯æœ€ä¼˜è§£ã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨å†™å‡ºç‰Œæç¤ºç®—æ³•æ—¶ï¼Œæœ€ä¸»è¦çš„ç›®æ ‡ï¼Œæ—¶æ ¹æ®ä¸Šå®¶æ‰‹ç‰Œï¼Œåˆ—å‡ºå½“å‰æ‰‹ç‰Œä¸­å¯å‡ºçš„ç»„åˆï¼Œä»å°åˆ°å¤§æç¤ºç»™ç”¨æˆ·ã€‚
```Lua
function getHintTable(outCardArr, handCardArr)
    local outCardSeq = genCardSeq(outCardArr)
    local outCardType = getCardType(ourCardSeq)
    local hintTable = {}
    -- å¤©ç‹ç‚¸ç›´æ¥GG
    if outCardType == JOKER_BOMB then
        return hintTable
    end

    if outCardType == SINGLE then
        table.concat(genSingleHint(handCardArr))
    elseif outCardType == DOUBLE then
        table.concat(genDoubleHint(handCardArr))

    ......
    
    end
    -- æœ€åæ·»åŠ ç‚¸å¼¹æç¤º
    table.concat(hintTable, genBombHint(handCardArr))
    return hintTable
end
```
